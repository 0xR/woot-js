'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _ramda = require('ramda');

var _ramda2 = _interopRequireDefault(_ramda);

var _oValidator = require('o-validator');

var _oValidator2 = _interopRequireDefault(_oValidator);

var wCharIdSchema = {
  clientId: _oValidator2['default'].required(_ramda2['default'].is(Number)),
  clock: _oValidator2['default'].required(_ramda2['default'].is(Number))
};

var wCharSchema = {
  id: _oValidator2['default'].required(_oValidator2['default'].validate(wCharIdSchema)),
  isVisible: _oValidator2['default'].required(_ramda2['default'].is(Boolean)),
  alpha: _oValidator2['default'].required(_ramda2['default'].is(String)),
  prevId: _oValidator2['default'].required(_oValidator2['default'].validate(wCharIdSchema)),
  nextId: _oValidator2['default'].required(_oValidator2['default'].validate(wCharIdSchema))
};

// makeWCharId :: {k: a} -> WCharId
var makeWChar = _oValidator2['default'].validateOrThrow(wCharSchema);

// makeWCharId :: Int -> Int -> WCharId
var makeWCharId = function makeWCharId(clientId, clock) {
  return _oValidator2['default'].validateOrThrow(wCharIdSchema, {
    clientId: clientId, clock: clock
  });
};

// wCharIdBeginning :: WCharId
var wCharIdBeginning = makeWCharId(-1, 0);

// wCharIdEnding :: WCharId
var wCharIdEnding = makeWCharId(-1, 1);

// -- special character to mark the beginning of a wString
// -- note: clientId of -1 denotes a special character generated by this library
// -- includes a self-referential 'prevId' field
// wCharBeginning :: WCharId
var wCharBeginning = makeWChar({
  id: wCharIdBeginning,
  isVisible: false,
  alpha: ' ',
  prevId: wCharIdBeginning,
  nextId: wCharIdEnding
});

// -- special character to mark the ending of a wString
// -- note: clientId of -1 denotes a special character generated by this library
// -- includes a self-referential 'nextId' field
// wCharEnding :: WCharId
var wCharEnding = makeWChar({
  id: wCharIdEnding,
  isVisible: false,
  alpha: ' ',
  prevId: wCharIdBeginning,
  nextId: wCharIdEnding
});

// hide :: WChar -> WChar
var hide = _ramda2['default'].assoc('isVisible', false);

// compareCharIds :: WCharId -> WCharId -> Ordering (-1, 0, 1)
var compareWCharIds = _ramda2['default'].comparator(function (idA, idB) {
  if (idA.clientId === idB.clientId) {
    return idA.clock < idB.clock;
  }

  return idA.clientId < idB.clientId;
});

exports['default'] = {
  makeWChar: makeWChar,
  makeWCharId: makeWCharId,
  wCharBeginning: wCharBeginning,
  wCharEnding: wCharEnding,
  hide: hide,
  compareWCharIds: compareWCharIds
};
module.exports = exports['default'];
//# sourceMappingURL=../woot/wchar.js.map